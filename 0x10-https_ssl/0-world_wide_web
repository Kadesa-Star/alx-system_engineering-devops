#!/usr/bin/env bash
# Script to report information about server domains

# Function to check domain and subdomain information
check_domain() {
  local domain=$1
  local subdomain=$2
  local subdomains="www lb-01 web-01 web-02"

  if [ -z "$domain" ]; then
    echo "Usage: $0 domain [subdomain]"
    exit 1
  fi

  # If no specific subdomain is provided, check all predefined subdomains
  if [ -z "$subdomain" ]; then
    echo "$subdomains" | awk -v domain="$domain" \
    'BEGIN { RS=" " }
    {
      cmd = "dig " $0 "." domain " +short"
      cmd | getline result
      close(cmd)
      if (result) {
        print "The subdomain " $0 " is a A record and points to " result
      } else {
        print "The subdomain " $0 " does not exist."
      }
    }'
  else
    dig_result=$(dig +short "$subdomain.$domain")
    if [ -n "$dig_result" ]; then
      echo "The subdomain $subdomain is a A record and points to $dig_result"
    else
      echo "The subdomain $subdomain does not exist."
    fi
  fi
}

# Call the function with the provided arguments
check_domain "$1" "$2"
